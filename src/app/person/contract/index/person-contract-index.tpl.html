<div class="mw card" ng-show="!isLoadingContracts">
  <div class="card-heading">
    <h3>{{ 'MY_CONTRACTS' | translate }}</h3>
  </div>

  <div class="card-body">

    <!-- own contracts -->

    <div class="alert alert-warning" ng-show="!ownContracts.length && !otherContracts.length">
      {{ 'PERSON.CONTRACT.LIST.NO_OWN_CONTRACTS' | translate }}
    </div>

    <div class="well" ng-show="ownContracts.length" ng-repeat="contract in ownContracts">
      <h4>{{ contract.type.name }}</h4>

      <p hide-gt-xs></p>

      <span ng-if="ownContracts.length == 1">
        <button class="btn btn-default" ui-sref="contractchoice">{{ 'PERSON.CONTRACT.CHANGE_CONTRACT' | translate }}</button>
      </span>

      <p hide-gt-xs></p>

      <span ng-if="contract.type.id !== 60">
        <button class="btn btn-default" ng-click="endContract($index)">{{ 'CONTRACT_END_ACTION' | translate }}</button>
      </span>

      <div id="edit_contract_button" ng-if="contract.type.id !== 60">
        <br>

        <form name="editForm">
          <div class="form-group">
            <label>{{ 'CONTRACT.PROP.OWNRISKWAIVER' | translate }}</label>
            <div class="radio" ng-if="contract.type.allowedReductions.indexOf('not') >= 0">
              <label>
              <input type="radio" value="not" ng-model="contract.ownRiskWaiver" />
                {{ 'CONTRACT.PROP.OWNRISKWAIVER.NOT.DESC' | translate }}<br/>
              </label>
            </div>

            <div class="radio">
              <label ng-if="contract.type.allowedReductions.indexOf('booking') >= 0">
                <input type="radio" value="booking" ng-model="contract.ownRiskWaiver" />
                <span>{{ 'CONTRACT.PROP.OWNRISKWAIVER.BOOKING.DESC' | translate }}<br/></span>
              </label>
            </div>

            <div class="radio">
              <label ng-if="contract.type.allowedReductions.indexOf('month') >= 0">
                <input type="radio" value="month" ng-model="contract.ownRiskWaiver" />
                <span>{{ 'CONTRACT.PROP.OWNRISKWAIVER.BOOKING.DESC_MONTH' | translate }}<br/></span>
              </label>
            </div>
          </div>
          <button class="btn btn-primary" ng-click="saveContract($index, editForm)" ng-disabled="busy || editForm.$pristine">
            {{ 'SAVE' | translate }}
          </button>
        </form>
        <br/>
      </div>

      <!-- edit_contract_button -->
      <div id="add_person_to_contract" ng-if="contract.type.id !== 60" ng-init="getExtraDriverRequestsForContract(contract);">
        <p><b>{{ 'PERSON.CONTRACT.OTHER_CONTRACTS_PERSONS' | translate }}:</b></p>
        <ul class="list-group">
          <!-- persons -->
          <li class="list-group-item" ng-repeat="result in personsOnContracts">
            <a href="" class="pull-right" ng-if="result.recipient.id" ng-click="removePerson(contract, result.recipient)">{{ 'REMOVE' | translate }}</a>
            <div ng-if="result.recipient.firstName && result.status === 'accepted'">
              {{ result.recipient.firstName }} {{ result.recipient.preposition }} {{ result.recipient.surname }} {{ result.recipient.email | surroundWith : '&lt;' : '&gt;' }}
            </div>
            <div ng-if="!result.recipient.firstName || result.status === 'invited'">
              {{ 'PERSON.CONTRACT.INVITED_PERSON' | translate }} {{ result.recipient.email | surroundWith : '&lt;' : '&gt;' }}
            </div>
          </li>
        </ul>

        <div class="text-center" style="margin-bottom: 20px;" ng-if="hasMoreToLoad">
          <button ng-click="loadMoreExtraDriverRequestsForContract(contract)" class="mywheels-btn mywheels-btn-normal mywheels-btn-big">
            <span ng-if="!showLoaderSpinner">Laad meer</span>
            <span ng-if="showLoaderSpinner"><i class="fa fa-spinner fa-spin"></i></span>
          </button>
        </div>

        <form name="form">
          <div class="input-group" ng-class="{ 'has-error' : form.email.$error.email }">
            <input type="email" required name="email" class="form-control" placeholder="{{ 'EMAIL' | translate }}" ng-model="contract.emailToAdd" />
            <div class="input-group-btn">
              <button class="btn btn-default"
                ng-disabled="form.email.$error.required || form.email.$error.email"
                ng-click="addPerson($index)">{{ 'ADD' | translate }}</button>
            </div>
          </div>
        </form>
      </div>

    </div>

    <!-- other contracts -->
    <div ng-show="otherContracts.length">
      <h2>{{ 'PERSON.CONTRACT.OTHER_CONTRACTS' | translate }}</h2>

      <ul class="list-group">
        <li class="list-group-item" ng-repeat="contract in otherContracts">
          <h4>{{ contract.type.name }} <small>({{ contract.id }})</small></h4>
          <b>
            {{ contract.contractor.firstName }}
            {{ contract.contractor.preposition }}
            {{ contract.contractor.surname }}</b>&nbsp;&lt;{{ contract.contractor.email }}&gt;
        </li>
      </ul>
    </div>

  </div>
</div>

<div class="card" id="menu-item-chipcards" ng-show="otherContracts.length">
  <div class="card-heading">
    <h3 class="card-title">
      <a href="" ui-sref="owm.person.invite-requests">{{ 'MY_PERMISSIONS' | translate }}</a>
    </h3>
  </div>
</div>