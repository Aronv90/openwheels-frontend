<div class="card">
  <div class="card-heading">
    <h2 class="card-title">
      {{ 'MY_TRIPS' | translate }}
    </h2>
  </div>

  <div class="card-body">

    <div class="row">
      <div class="col-xs-12">
        <div class="form-group">
          <select class="form-control" ng-options="year for year in years" ng-model="selectedYear"></select>
        </div>
      </div>
    </div>

    <div class="row" ng-if="!totalBookings.asOwner && !totalBookings.asRenter">
      <div class="col-xs-12">
        <h3 ng-if="showLoaderSpinner" class="text-center" style="margin-top:10px;"><i class="fa fa-spinner fa-spin fa-fw text-primary"></i></h3>
        <span ng-if="!showLoaderSpinner && totalBookings.asRenter === 0 && totalBookings.asOwner === 0">{{ 'NO_TRIPS' | translate }}</span>
      </div>
    </div>
  </div>

</div>

<div class="card" ng-if="totalBookings.asRenter > 0">
  <div class="card-heading">
    <h3 class="card-title">
      {{ 'TRIPS_BOOKINGS_FOR_RENTER' | translate }}
    </h3>
  </div>

  <div class="card-body">

    <button class="btn" ng-click="prevPage('asRenter')" ng-disabled="curPage.asRenter == 1"> &lt; </button>
    <p class="btn">{{ curPage.asRenter }}</p>
    <button class="btn" ng-click="nextPage('asRenter')" ng-disabled="curPage.asRenter >= lastPage.asRenter"> &gt; </button>

    <div ng-if="showLoaderSpinner" class="text-center" style="margin-top:10px;">
      <h3><i class="fa fa-spinner fa-spin fa-fw text-primary"></i></h3>
    </div>

    <table class="table" ng-if="!showLoaderSpinner">
      <thead>
        <tr>
          <th>{{ 'DATE' | translate }}</th>
          <th hide-xs>{{ 'STATUS' | translate }}</th>
          <th>{{ 'RESOURCE' | translate }}</th>
          <th>{{ 'OWNER' | translate }}</th>
          <th hide-xs></th>
          <th hide-xs></th>
        </tr>
      </thead>
      <tbody>
        <tr 
          ng-class="{danger: ['cancelled', 'owner_cancelled'].indexOf(booking.status) >= 0, warning: booking.status === 'rejected'}"
          ng-repeat="booking in bookings.asRenter | orderBy:['booking.beginBooking','booking.beginRequested']"
          class="clickable-row"
          ui-sref="owm.booking.show({bookingId: booking.id})"
        >
          <td><a ui-sref="owm.booking.show({bookingId: booking.id})">
            {{ (booking.beginBooking | amDateFormat:'DD-MM-YYYY') || (booking.beginRequested | amDateFormat:'DD-MM-YYYY') }}
          </a></td>
          <td hide-xs>{{ booking.status | bookingStatus }}</td>
          <td>{{ booking.resource.alias}}</td>
          <td>{{ booking.resource.owner | fullname }}</td>
          <td hide-xs><span booking-approval-icon="booking"></span></td>
          <td class="text-right" hide-xs>
            <a ui-sref="owm.booking.show({bookingId: booking.id})">Details</a>
            <a ng-if="provider === 50" target="_blank" ng-href="{{ createTripDetailsLink(booking) }}"><i class="fa fa-fw fa-external-link-square"></i>PDF</a>
          </td>
        </tr>
      </tbody>
    </table>

  </div>
</div>

<div class="card" ng-if="totalBookings.asOwner > 0">
  <div class="card-heading">
    <h3 class="card-title">
      {{ 'TRIPS_BOOKINGS_FOR_OWNER' | translate }}
    </h3>
  </div>

  <div class="card-body">
    <button class="btn" ng-click="prevPage('asOwner')" ng-disabled="curPage.asOwner == 1"> &lt; </button>
    <p class="btn">{{ curPage.asOwner }}</p>
    <button class="btn" ng-click="nextPage('asOwner')" ng-disabled="curPage.asOwner >= lastPage.asOwner"> &gt; </button>

    <div ng-if="showLoaderSpinner" class="text-center" style="margin-top:10px;">
      <h3><i class="fa fa-spinner fa-spin fa-fw text-primary"></i></h3>
    </div>

    <table class="table" ng-if!="showLoaderSpinner">
      <thead>
        <tr>
          <th>{{ 'DATE' | translate }}</th>
          <th hide-xs>{{ 'STATUS' | translate }}</th>
          <th>{{ 'RESOURCE' | translate }}</th>
          <th>{{ 'RENTER' | translate }}</th>
          <th hide-xs></th>
        </tr>
      </thead>
      <tbody>
        <tr
          ng-class="{danger: ['cancelled', 'owner_cancelled'].indexOf(booking.status) >= 0, warning: booking.status === 'rejected'}"
          ng-repeat="booking in bookings.asOwner | orderBy:['booking.beginBooking','booking.beginRequested']"
          class="clickable-row"
          ui-sref="owm.booking.show({bookingId: booking.id})"
        >
          <td><a ui-sref="owm.booking.show({bookingId: booking.id})">
            {{ (booking.beginBooking | amDateFormat:'DD-MM-YYYY') || (booking.beginRequested | amDateFormat:'DD-MM-YYYY') }}
          </a></td>
          <td hide-xs>{{ booking.status | bookingStatus }}</td>
          <td>{{ booking.resource.alias }}</td>
          <td>{{ booking.person | fullname }}</td>
          <td class="text-right" hide-xs>
            <a ui-sref="owm.booking.show({bookingId: booking.id})">Details</a>
            <a ng-if="provider === 50" target="_blank" ng-href="{{ createTripDetailsLink(booking) }}"><i class="fa fa-fw fa-external-link-square"></i>PDF</a>
          </td>
        </tr>
      </tbody>
    </table>

  </div>
</div>