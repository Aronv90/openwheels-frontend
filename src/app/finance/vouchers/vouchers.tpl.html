<div class="card" ng-init="showVouchers=true">
  <div class="card-heading">
    <h3 class="card-title">
      <a href="" ng-click="showVouchers = !!!showVouchers">
        <i class="fa fa-fw" ng-class="{ 'fa-chevron-right': !showVouchers, 'fa-chevron-down': showVouchers }"></i>
        Mijn tegoed <info-icon tooltip-html="'Koop rijtegoed om je ritten te betalen. Je kunt het eenvoudig terug laten storten.'"></info-icon>
        <!-- exclamation mark if there are unpaid invoiceGroups -->
        <i ng-if="unpaidInvoiceGroups.length > 0" class="fa fa-exclamation-triangle text-danger" tooltip="Tooltip"></i>
      </a>
    </h3>
  </div>

  <div collapse="!showVouchers">
    <div class="card-body">

      <!-- credit -->
      <div style="margin-bottom: 15px;">
        <span ng-if="!credit" class="text-muted">
          <i class="fa fa-spin fa-spinner"></i>&nbsp;Tegoed ophalen...
        </span>

        <div ng-if="credit && !credit.error">

          <h1>{{ credit.value | currency }}</h1>

          <!-- vouchers list -->
          <div ng-if="credit.value > 0">
            <a href="" ng-click="toggleVoucherList(!!!showVoucherList)">
              <i class="fa fa-fw" ng-class="{ 'fa-chevron-right': !showVoucherList, 'fa-chevron-down': showVoucherList }"></i>
              Toon tegoedbonnen
            </a>
          </div>
          <div collapse="!showVoucherList">
            <div ng-if="vouchers && !vouchers.length">{{ 'NO_RESULTS' | translate }}</div>
            <ul ng-if="vouchers && vouchers.length" class="list-unstyled list-spaced list-bordered fa-ul" style="margin-top: 15px">
              <li ng-repeat="voucher in vouchers">
                <i class="text-success fa fa-li fa-gift"></i>
                {{ voucher.value | currency }}
                <span class="text-muted">
                  <span ng-if="voucher.value !== voucher.initialValue"> over van {{ voucher.initialValue | currency }}</span>
                  gekocht op {{ voucher.paid | amDateFormat : 'DD-MM-YY HH:mm' }}
                </span>
              </li>
            </ul>
          </div>
        </div>

        <span ng-if="credit.error">
          <i class="fa fa-warning text-warning"></i>&nbsp;Je tegoed is op dit moment niet beschikbaar
        </span>
      </div>

      <!-- notice -->
      <div ng-if="requiredValue" style="margin-bottom: 15px;">

        <div class="alert alert-warning" ng-if="requiredValue.value.voucher > 0">
          <info-icon tooltip-html="'Omdat we nog niet weten hoeveel kilometers je zal rijden vragen we je meer rijtegoed te kopen dan je rit waarschijnlijk zal kosten. Dit bedrag vraag je na je rit eenvoudig terug, of bewaar je voor een volgende rit'"></info-icon>
          Je hebt nog {{ requiredValue.value.voucher | currency }} (extra) rijtegoed nodig voor jouw reserveringen.
          Klik <a href="" ng-click="showRequiredValueDetails(requiredValue.value)">hier</a> om te zien hoe dit bedrag is opgebouwd
        </div>

        <span ng-if="credit.value && !requiredValue.error && !(requiredValue.value.voucher > 0)">
          Je hebt voldoende rijtegoed voor jouw huidige reserveringen.
          Klik <a href="" ng-click="showRequiredValueDetails(requiredValue.value)">hier</a> voor details
        </span>

        <span ng-if="requiredValue.error && !credit.error">
          <i class="fa fa-warning text-warning"></i>&nbsp;
          We kunnen op dit moment niet zien of je voldoende rijtegoed hebt voor jouw reserveringen
        </span>
      </div>

      <!-- call to action (buy voucher)-->
      <div ng-show="credit && !showVoucherOptions" style="margin-bottom: 15px">

        <!-- button with suggested value -->
        <div ng-if="requiredValue.value.voucher > 0">
          <button type="button" class="btn btn-success" ng-click="buyVoucher(requiredValue.value.voucher)">
            Koop tegoedbon van {{ requiredValue.value.voucher | currency }}
          </button>
          <button type="button" class="btn btn-link" ng-click="toggleVoucherOptions(true)">
            Ander bedrag
          </button>
        </div>

        <!-- button toggle voucher options -->
        <div ng-if="!(requiredValue.value.voucher > 0)">
          <button type="button" class="btn btn-success" ng-click="toggleVoucherOptions(true)">Koop tegoedbon</button>
        </div>
      </div>

      <!-- voucher options -->
      <div ng-show="showVoucherOptions" style="margin-bottom: 15px;">
        <div style="margin-bottom: 5px"><b>Kies bedrag</b></div>
        <div class="clearfix" style="margin: 0 -5px 15px -5px">
          <div ng-repeat="option in voucherOptions" class="pull-left" style="width: 20%; padding: 5px">
            <button ng-click="buyVoucher(option)" type="button" class="btn btn-block btn-success">{{ option | currency }}</button>
          </div>
        </div>
        <a href="" ng-click="toggleVoucherOptions(false)">Annuleren</a>
      </div>

    </div><!-- /body -->
  </div><!-- /collapse -->
</div><!-- /card -->
