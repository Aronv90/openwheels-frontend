<div class="card" ng-if="previousState.name == 'owm.finance.v4'">
  <div class="card-body card-inverse">
    <a ui-sref="owm.finance.v4"><i class="fa fa-fw fa-chevron-left"></i>Terug naar financieel overzicht</a>
  </div>
</div>

<div class="card" ng-if="previousState.name == 'owm.trips'">
  <div class="card-body card-inverse">
    <a ui-sref="owm.trips" ng-if="userPerspective === 'renter'"><i class="fa fa-fw fa-chevron-left"></i>Terug naar ritgeschiedenis</a>
    <a ui-sref="owm.trips" ng-if="userPerspective === 'owner'"><i class="fa fa-fw fa-chevron-left"></i>Terug naar verhuurgeschiedenis</a>
  </div>
</div>

<div class="card" ng-if="previousState.name == 'owm.person.dashboard'">
  <div class="card-body card-inverse">
    <a ui-sref="owm.person.dashboard"><i class="fa fa-fw fa-chevron-left"></i>Terug naar dashboard</a>
  </div>
</div>

<!-- Information block for renter if this is the thank you page -->
<!-- <div class="card" ng-if="previousState.name == 'owm.resource.show' && userPerspective ==='renter' && ['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) < 0"> -->
  <!-- If booking is ok -->
<!--   <div class="card-body card-inverse" ng-if="booking.ok">
    <h2 class="text-white">Bedankt voor je boeking!</h2>
    <p class="text-white">
      Alles is in orde voor je boeking, je kunt goed verzekerd op weg.
    </p>
  </div> -->
  <!-- If renter needs to pay -->
<!--   <div class="card-body card-inverse" ng-if="!booking.ok && booking.approved === 'BUY_VOUCHER' && previousState.name == 'owm.resource.show'">
    <h2 class="text-white">Bijna klaar! Alleen nog rijtegoed kopen</h2>
    <p class="text-white">
      Je reservering is gemaakt. Je hoeft enkel de reservering nog te betalen.
    </p>
  </div> -->
  <!-- If booking is not ok -->
<!--   <div class="card-body card-inverse" ng-if="booking.status === 'requested'">
    <h2 class="text-white">Je huurverzoek is verzonden</h2>
    <p class="text-white">
      Je ontvangt een mail van ons als de verhuurder op je huurverzoek heeft gereageerd.
    </p>
  </div>
</div> -->

<md-card class="ow-card">
  <div class="md-card-image" style="position: relative">
    <div resource="resource" size="normal" class="ng-isolate-scope">
      <img class="media-object img-resource-large pull-left" ng-src="{{ resource.pictures[0] | resourceAvatar:'large' }}" />
    </div>
  </div>
  <div style="position: relative">
    <md-card-title>
      <md-card-title-text>
        <a ui-sref="owm.resource.show({ resourceId: resource.id, city: resource.city })">
          <h3 class="no-margin" style="font-size: 2rem">
            <span>{{ resource.alias || ('RESOURCE_NO_NAME' | translate) }} {{ resource.registrationPlate | surroundWith : '(' : ')' }}</span>
          </h3>
        </a>
      </md-card-title-text>
    </md-card-title>
    <md-card-body class="ow-list-compact">
      <md-list class="margin-right" role="list">
        <md-list-item role="listitem" class="md-no-proxy">
          <md-icon class="text-success material-icons">directions_car</md-icon>
          <div flex="" class="flex">
            {{ (resource.brand | toTitleCase) || ('UNKNOWN_BRAND' | translate) }} {{ resource.model | toTitleCase }}
            <span ng-if="hasAcceptedTimeframe(booking)" class="tag tag-{{ booking.status }} pull-right">{{ booking.status | bookingStatus }}</span>
            <span ng-if="!hasAcceptedTimeframe(booking) && ['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) < 0" class="tag tag-requested pull-right">{{ 'requested' | bookingStatus }}</span>
            <span ng-if="['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) >= 0" class="tag tag-requested pull-right">{{ 'cancelled' | bookingStatus }}</span>
          </div>
        </md-list-item>
        <md-list-item role="listitem" class="md-no-proxy">
          <md-icon class="text-success material-icons">place</md-icon>
          <div flex="" class="flex">
            {{ resource.location }} {{ resource.streetNumber }} <small>{{ resource.city  | toTitleCase }}</small>
          </div>
        </md-list-item>

        <div id="started" ng-if="hasAcceptedTimeframe(booking)">
          <md-list-item role="listitem" class="md-no-proxy">
            <md-icon class="text-success material-icons">arrow_forward</md-icon>
            <div flex="" class="flex">
              <datetime datetime="{{ booking.beginBooking }}"></datetime>
            </div>
          </md-list-item>

          <md-list-item role="listitem" class="md-no-proxy">
            <md-icon class="text-success material-icons">arrow_back</md-icon>
            <div flex="" class="flex">
              <datetime datetime="{{ booking.endBooking }}"></datetime>
            </div>
          </md-list-item>
        </div>

        <div id="requested" ng-if="!hasAcceptedTimeframe(booking)">
          <md-list-item role="listitem" class="md-no-proxy">
            <md-icon class="text-warning material-icons">arrow_forward</md-icon>
            <div flex="" class="flex">
              <datetime datetime="{{ booking.beginRequested }}"></datetime>
            </div>
          </md-list-item>

          <md-list-item role="listitem" class="md-no-proxy">
            <md-icon class="text-warning material-icons">arrow_back</md-icon>
            <div flex="" class="flex">
              <datetime datetime="{{ booking.endRequested }}"></datetime>
            </div>
          </md-list-item>
        </div>

      </md-list>
    </md-card-body>
  </div>
</md-card>

<div class="card" ng-if="allowOvereenkomst && !bookingEnded">
  <div class="card-heading">
    <h3 class="card-title">
      <a  href="{{ overeenkomstUrl }}" target="_blank" ng-href="{{ overeenkomstUrl }}">
        <md-icon class="btn-link">file_download</md-icon>
        Download huurovereenkomst
      </a>
    </h3>
  </div>
</div>

<div class="card" ng-if="userPerspective==='renter' && booking.approved === 'BUY_VOUCHER' && ['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) < 0">
  <div class="card-body card-inverse" style="background-color:#5faac8; color:white;" layout="row" layout-xs="column">
    <div flex="75" flex-xs="100">
      <h3 style="color:#fff; margin-bottom:10px;">Reservering betalen</h3>
      Je reservering is nog niet definitief omdat je te weinig rijtegoed hebt.</div>
    <div flex="25" flex-xs="100"><md-button class="md-raised" ui-sref="owm.finance.vouchers">Koop rijtegoed</md-button></div>
  </div>
</div>

<div class="card" ng-if="userPerspective==='renter' && hasRequestedTimeframe(booking) && hasAcceptedTimeframe(booking)">
  <div class="card-body card-inverse" style="background-color:#e6a500; color:white;">
    <span>De wijzging van je reeds geaccepteerde verzoek is naar de verhuurder verstuurd. Na goedkeuring ontvang je per mail een bevestiging. Pas dan is je rit verlengd.</span>
  </div>
</div>

<div class="card" ng-if="userPerspective==='owner' && ['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) < 0 && !bookingRequestEnded && !bookingEnded">
  <div class="card-heading">
    <h3 class="card-title">
      <span ng-if="userPerspective==='owner' && !hasAcceptedTimeframe(booking)">
        {{ booking.person.firstName | wantsToRent : booking.resource }}
      </span>

      <span ng-if="userPerspective==='owner' && hasAcceptedTimeframe(booking) && !hasRequestedTimeframe(booking)">
      {{ booking.person.firstName | hasRented : booking.resource }}
      </span>

      <span ng-if="userPerspective==='owner' && hasAcceptedTimeframe(booking) && hasRequestedTimeframe(booking)">
      {{ booking.person.firstName | wantsToChangeBooking }}
      </span>
    </h3>
  </div>
  <div uib-collapse="editOwnerBookingIsOpen">
    <div class="card-body">
      <div class="row" ng-if="userPerspective==='owner' && hasAcceptedTimeframe(booking) && hasRequestedTimeframe(booking)" style="text-align:center; margin-bottom:15px;">
        <div class="col-md-4">
          <div style="min-height: 40px;">
            <md-icon class="text-warning material-icons">arrow_forward</md-icon>
            <datetime style="display: inline;" datetime="{{ booking.beginRequested }}"></datetime>
          </div>
          <div style="min-height: 40px;">
            <md-icon class="text-warning material-icons">arrow_back</md-icon>
            <datetime style="display: inline;" datetime="{{ booking.endRequested }}"></datetime>
          </div>
          <span ng-if="!hasAcceptedTimeframe(booking)" class="tag tag-{{ booking.status }}">{{ booking.status | bookingStatus }}</span>
          <span ng-if="hasAcceptedTimeframe(booking)" class="tag tag-requested">{{ 'requested' | bookingStatus }}</span>
        </div>
        <div class="col-md-4" style="padding-bottom: 25px;">
          <md-icon class="material-icons" style="margin-top: 23px;">compare_arrows</md-icon>
        </div>
        <div class="col-md-4">
          <div style="min-height: 40px;">
            <md-icon class="text-success material-icons">arrow_forward</md-icon>
            <datetime style="display: inline;" datetime="{{ booking.beginBooking }}"></datetime>
          </div>
          <div style="min-height: 40px;">
            <md-icon class="text-success material-icons">arrow_back</md-icon>
            <datetime style="display: inline;" datetime="{{ booking.endBooking }}"></datetime>
          </div>
          <span ng-if="!hasAcceptedTimeframe(booking)" class="tag tag-{{ booking.status }}">{{ booking.status | bookingStatus }}</span>
          <span ng-if="hasAcceptedTimeframe(booking)" class="tag tag-accepted">{{ 'accepted' | bookingStatus }}</span>
      </div>
      </div>
      <div class="allowAcceptReject">
        <div class="text-center" ng-if="allowAcceptReject">
          <div class="form-group">
            <label>{{ 'BOOKING.REMARK_AUTHORIZER_LABEL' | translate }}</label>
            <textarea class="form-control" ng-model="userInput.acceptRejectRemark" />
          </div>
          <button type="button" class="btn btn-success" ng-click="acceptBooking(booking)">Accepteren</button>
          <button type="button" class="btn btn-danger" ng-click="rejectBooking(booking)">Weigeren</button>
        </div>
      </div>
      <div class="" ng-if="userPerspective==='owner' && hasAcceptedTimeframe(booking) && booking.ok && booking.approved !== 'BUY_VOUCHER' && !hasRequestedTimeframe(booking)">
        Alles voor deze rit is geregeld, je kunt de auto meegeven aan de huurder.
      </div>
      <div class="row text-center" ng-if="allowCancel" style="margin-top:10px;">
        <button class="btn btn-default"  ng-click="cancelBooking(booking)">
          {{ 'CANCEL_BOOKING' | translate }}
        </button>
      </div>

    </div>
  </div>
</div>

<div class="card" ng-if="userPerspective==='owner' && (!booking.ok || booking.approved === 'BUY_VOUCHER')">
  <div class="card-body card-inverse" style="background-color:#c85f5f; color: white;">
    <span>Voor deze rit is nog niet alles in orde. Mogelijk moet de huurder nog betalen of andere gegevens doorgeven. Geef de auto daarom niet mee aan de huurder zolang deze melding zichtbaar is.
      <span ng-if="allowAcceptReject"><br>Je kan de rit wel alvast accepteren of weigeren</span></span>
  </div>
</div>

<!-- Booking altered after buy voucher -->
<div class="card" ng-if="alteredAfterBuyVoucher">
  <div class="card-body card-inverse" style="background-color:#3bab78; color: white;">
    <span>Gelukt! De betaling is ontvangen en de reservering is gewijzigd.</span>
  </div>
</div>

<!-- FORM -->
<div id="bookingFormContainer" uib-collapse="!showBookingForm" ng-if="userPerspective === 'renter' && ['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) < 0">
  <div class="card" ng-init="!editBookingIsOpen" >
    <div class="card-heading">
      <h3 class="card-title">
        <a ng-click="toggleEditBookingCard()">
          <i class="fa fa-fw" ng-class="{ 'fa-chevron-right': !editBookingIsOpen, 'fa-chevron-down': editBookingIsOpen }"></i>
          Reservering wijzigen
        </a>

      </h3>
    </div>
    <div uib-collapse="!editBookingIsOpen">
      <div class="card-body">

        <div class="resource__boardcomputer text-center" id="resource__boardcomputer" ng-if="allowBoardComputer">
          <ul class="list-inline">
            <li>
              <button ng-click="openDoor(resource)" class="btn btn-lg btn-default btn-success"><i class="fa fa-unlock fa-fw fa-lg"></i></button>
            </li>
            <li>
              <button ng-click="closeDoor(resource)" class="btn btn-lg btn-default btn-danger"><i class="fa fa-lock fa-fw fa-lg"></i></button>
            </li>
          </ul>
        </div>

        <div class="booking-form" >
          <form class="booking" timeframe begin="bookingRequest.beginRequested" end="bookingRequest.endRequested">
            <div class="form-group" ng-if="allowEdit">
              <label for="beginRequested">
                {{ 'DATE_START' | translate }}&nbsp;
                <button id="booking_now_button" type="button" class="btn btn-warning btn-xs" ng-click="setTimeframe(bookingRequest, 0)">{{ 'NOW' | translate }}</button>
              </label>
              <div class="row">
                <div class="col-xs-7">
                  <input id="beginRequested" type="text" placeholder="{{ 'DATE' | translate }}" class="form-control pickadate-input" ng-model="bookingRequest.beginRequested" pickadate="dateConfig">
                </div>
                <div class="col-xs-5">
                  <input id="endBequested" type="text" placeholder="{{ 'TIME' | translate }}" class="form-control pickadate-input" ng-model="bookingRequest.beginRequested" pickatime="timeConfig">
                </div>
              </div>
            </div>

            <div class="form-group" ng-if="allowEdit">
              <label for="endTrip">
                {{ 'DATE_END' | translate }}&nbsp;
                <button type="button" class="btn btn-default btn-xs" ng-click="extendBooking(bookingRequest, 1)">{{ 'PLUS_1_HOUR' | translate }}</button>
                <button type="button" class="btn btn-default btn-xs" ng-click="extendBooking(bookingRequest, 2)">{{ 'PLUS_2_HOUR' | translate }}</button>
                <button type="button" class="btn btn-default btn-xs" ng-click="extendBooking(bookingRequest, 4)">{{ 'PLUS_4_HOUR' | translate }}</button>
              </label>
              <div class="row">
                <div class="col-xs-7">
                  <input type="text" placeholder="{{ 'DATE' | translate }}" class="form-control pickadate-input" ng-model="bookingRequest.endRequested" pickadate="dateConfig">
                </div>
                <div class="col-xs-5">
                  <input type="text" placeholder="{{ 'TIME' | translate }}" class="form-control pickadate-input" ng-model="bookingRequest.endRequested" pickatime="timeConfig">
                </div>
              </div>
            </div>

            <div class="form-group" ng-if="allowEdit">
              <label for="endTrip" ng-bind="'BOOKING.REMARK_REQUESTER_LABEL' | translate"></label>
              <textarea class="form-control" ng-model="bookingRequest.remarkRequester"></textarea>
            </div>

            <!-- pay button -->
            <div class="form-group" ng-if="extraCredit">
              <div class="text-center">
                <button type="button" class="btn btn-success" ng-click="buyVoucher(extraCredit)">
                  Koop {{ extraCredit | currency }} rijtegoed
                </button>
              </div>
            </div>

            <!-- buttons -->
            <div class="text-center" ng-if="!extraCredit">
              <p>
                <button class="btn btn-primary" ng-if="allowEdit"
                        ng-disabled="bookingRequest.beginRequested === booking.beginBooking && bookingRequest.endRequested === booking.endBooking"
                        ng-click="editBooking(bookingRequest)">
                  {{ 'EDIT_BOOKING' | translate }}
                </button>

                <button class="btn btn-default" ng-if="allowCancel"
                        ng-click="cancelBooking(booking)">
                  {{ 'CANCEL_BOOKING' | translate }}
                </button>
              </p>
              <p>
                <button class="btn btn-default" ng-if="allowStop"
                        ng-click="stopBooking(booking)">
                  {{ 'STOP_BOOKING' | translate }}
                </button>

                <button class="btn btn-default" ng-disabled="hasDiscount" ng-click="openDiscountDialog();" ng-if="userPerspective === 'renter'">
                  Kortingscode toevoegen
                </button>
              </p>

              <div ng-if="allowAcceptReject">
                <div class="form-group">
                  <label>{{ 'BOOKING.REMARK_AUTHORIZER_LABEL' | translate }}</label>
                  <textarea class="form-control" ng-model="userInput.acceptRejectRemark" />
                </div>
                <button type="button" class="btn btn-success" ng-click="acceptBooking(booking)">Accepteren</button>
                <button type="button" class="btn btn-danger" ng-click="rejectBooking(booking)">Weigeren</button>
              </div>

            </div>

          </form>
          <form class="addExtraDriver">

          </form>
        </div>
      </div>

    </div>
  </div>
</div><!--/ FORM -->

<!-- <div class="card" ng-init="!paymentIsOpen" ng-if="userPerspective === 'renter' && !booking.ok && ['cancelled', 'owner_cancelled', 'rejected'].indexOf(booking.status) < 0">
  <div class="card-heading">
      <span class="pull-right" ng-if="false">
        <small hide-xs style="padding-left: 1em" ng-if="booking.cancelAfter && booking.status != 'OK'">Betaal voor {{booking.cancelAfter|amDateFormat:'D MMMM YYYY HH:mm'}} om annulering te voorkomen</small>
        <md-icon ng-show="booking.statusValue" ng-class="{'text-success': booking.statusValue}">check</md-icon>
        <b ng-class="{'text-success': booking.statusValue}" ng-if="booking.details.discount">{{ booking.details.booking_price.total + booking.details.km_price - booking.details.discount | currency }}</b>
        <b ng-class="{'text-success': booking.statusValue}" ng-if="!booking.details.discount">{{ booking.details.booking_price.total + booking.details.km_price | currency }}</b>
      </span>
    <h3 class="card-title">
      <a ng-click="togglePaymentCard()">
        <i class="fa fa-fw" ng-class="{ 'fa-chevron-right': !paymentIsOpen, 'fa-chevron-down': paymentIsOpen }"></i>
        Rit betalen
      </a>
      <small hide-gt-xs style="padding-top: 1em;" ng-if="booking.isOpen && booking.cancelAfter && booking.status != 'OK'"><br>Betaal voor {{booking.cancelAfter|amDateFormat:'D MMMM YYYY HH:mm '}} om annulering te voorkomen</small>
    </h3>
  </div>

  <div uib-collapse="!paymentIsOpen">
    <div class="card-body">
      <voucher me="me" booking="booking" on-changed="bookingChanged(booking)"></voucher>
      <div>
        <button type="button" ng-if="requiredValue.value.total <= 0" class="btn btn-success" ng-click="buyVoucher(booking.details.booking_price.total + booking.details.km_price - booking.details.discount)">
          Koop {{ booking.details.booking_price.total + booking.details.km_price - booking.details.discount | currency }} rijtegoed
        </button>
      </div>
    </div>
    <div class="card-body" ng-if="requiredValue.value.total > 0">
      <h2>Rijtegoed</h2>
      <div style="margin-bottom: 15px;">

        <table class="table">
          <tr>
          <tr>
            <td style="width:100%">Benodigd voor je reserveringen</td>
            <td class="text-right">{{ requiredValue.value.sub_total | currency }}</td>
          </tr>
          <tr ng-if="requiredValue.value.debt > 0">
            <td>Openstaande facturen</td>
            <td class="text-right">{{ requiredValue.value.debt | currency }}</td>
          </tr>
          <tr>
            <td>Af: je huidige rijtegoed</td>
            <td class="text-right">{{ requiredValue.value.credit | currency }}</td>
          </tr>
          <tr>
            <td ng-if="requiredValue.value.sub_total >= 0"><b>Te betalen</b></td>
            <td ng-if="requiredValue.value.total < 0"><b>Resterend rijtegoed</b></td>
            <td class="text-right"><b>{{ requiredValue.value.total + (booking.details.booking_price.total + booking.details.km_price)  | currency }}</b></td>
          </tr>
        </table>

        <div ng-show="!showVoucherOptions">

          <div>
            <button type="button" class="btn btn-success" ng-click="buyVoucher(requiredValue.value.voucher)">
              Koop {{ requiredValue.value.total + (booking.details.booking_price.total + booking.details.km_price)  | currency }} rijtegoed
            </button>
          </div>
        </div>

        <div ng-if="!accountApproved">
          <p class="mywheels-btn-margin-top">
            <b>Let op:</b> om de betaling te kunnen verwerken, moet de tenaamstelling van de rekening overeenkomen met je accountnaam.
          </p>
        </div>
      </div>
    </div>

  </div>
</div> -->

<!-- remarks -->
<div class="card" ng-if="booking.remarkRequester || booking.remarkAuthorizer">
  <div class="card-heading">
    <h2 class="card-title">Opmerkingen</h2>
  </div>
  <div class="card-body">
    <div class="booking__remarks text-left">
      <div class="booking__remarks__remark" ng-if="booking.remarkRequester">
        <h4>{{ booking.person | fullname }}:</h4>
        {{ booking.remarkRequester }}
      </div>
      <div class="booking__remarks__remark" ng-if="booking.remarkAuthorizer">
        <hr/>
        <h4>{{ booking.resource.owner | fullname }}:</h4>
        {{ booking.remarkAuthorizer }}
      </div>
    </div>
  </div>
</div>

<!-- owner information -->
<div class="card"  ng-if="userPerspective === 'renter'">
  <div class="card-heading">
    <h3 class="card-title">
      Gegevens van {{ resource.owner.firstName }}
    </h3>
  </div>
  <div class="card-body">
    <div class="media">
      <img class="media-object pull-left img-user-small" person-profile-image="{ person: resource.owner, size: 'small' }" hide-xs />
      <div class="media-body">
        <ul class="list-unstyled list-block list-spaced">
          <li><md-icon>person_outline</md-icon>
            {{ resource.owner | fullname }}
          </li>
          <li ng-if="resource.owner.created"><md-ico>perm_contact_calendar</md-icon> 
            {{ resource.owner.created | memberSince }}
          </li>
          <li ng-if="resource.owner.streetName"><md-icon>place</md-icon>
            {{ resource.owner.streetName }} {{ resource.owner.streetNumber }}, {{ resource.owner.city }}
          </li>
          <li ng-if="resource.owner.phoneNumbers[0].number"><md-icon>phone</md-icon>
            <a href="tel:{{ resource.owner.phoneNumbers[0].number }}">{{ resource.owner.phoneNumbers[0].number }}</a>
            <small ng-if="resource.owner.phoneNumbers[0].verified" class="text-success">(geverifieerd)</small>
          </li>
          <li><md-icon>check</md-icon>
            {{ resource.numberOfBookings | wasBookedTimes }}
          </li>
          <li ng-if="resource.owner.facebookUid"><md-icon>share</md-icon>
            <a target="_blank" ng-href="https://facebook.com/{{ resource.owner.facebookUid }}">Facebook</a>
          </li>
          <li ng-if="resource.owner.twitterUid"><md-icon>share</md-icon>
            <a target="_blank" ng-href="https://twitter.com/{{ resource.owner.twitterUid }}">Twitter</a>
          </li>
          <li ng-if="resource.owner.linkedinUid"><md-icon>share</md-icon>
            <a target="_blank" ng-href="https://www.linkedin.com/profile/view?id={{ resource.ownerbooking.person.linkedinUid }}">LinkedIn</a>
          </li>
          <li><md-icon>comment</md-icon>
            <a ng-click="openChatWith(resource.owner)">{{ 'SEND_MESSAGE' | translate }}</a>
          </li>
        </ul>
        <div><span badge-list="booking.person.badges"></span></div>
      </div>
    </div>
  </div>
</div>

<!-- renter information -->
<div class="card" ng-if="userPerspective === 'owner'">
  <div class="card-heading">
    <h3 class="card-title">
        Gegevens van {{ booking.person.firstName }}
    </h3>
  </div>
  <div class="card-body">
    <div class="media">
      <img class="media-object pull-left img-user-small" person-profile-image="{ person: booking.person, size: 'small' }" hide-xs />
      <div class="media-body">
        <ul class="list-unstyled list-block list-spaced">
          <li><md-icon>person_outline</md-icon>
            {{ booking.person | fullname }}
          </li>
          <li ng-if="booking.person.created"><md-icon>perm_contact_calendar</md-icon> 
            {{ booking.person.created | memberSince }}
          </li>
          <li ng-if="booking.person.streetName"><md-icon>place</md-icon>
            {{ booking.person.streetName }} {{ booking.person.streetNumber }}, {{ booking.person.city }}
          </li>
          <li ng-if="booking.person.phoneNumbers[0].number"><md-icon>phone</md-icon>
            {{ booking.person.phoneNumbers[0].number }}
            <small ng-if="booking.person.phoneNumbers[0].verified" class="text-success">(geverifieerd)</small>
          </li>
          <li><md-icon>check</md-icon>
            {{ person.numberOfBookings | hasBookedTimes }}
          </li>
          <li ng-if="booking.person.facebookUid"><md-icon>share</md-icon>
            <a target="_blank" ng-href="https://facebook.com/{{ booking.person.facebookUid }}">Facebook</a>
          </li>
          <li ng-if="booking.person.twitterUid"><md-ico>share</md-icon>
            <a target="_blank" ng-href="https://twitter.com/{{ booking.person.twitterUid }}">Twitter</a>
          </li>
          <li ng-if="booking.person.linkedinUid"><md-icon>share</md-icon>
            <a target="_blank" ng-href="https://www.linkedin.com/profile/view?id={{ booking.person.linkedinUid }}">LinkedIn</a>
          </li>
          <li><md-icon>comment</md-icon>
            <a ng-click="openChatWith(booking.person)">{{ 'SEND_MESSAGE' | translate }}</a>
          </li>
        </ul>
        <div>
          <br>Bekijk het profiel van <a ui-sref="member({ personId: booking.person.id })">{{ booking.person.firstName }}</a> voor meer informatie en reviews.
        </div>
        <div><span badge-list="booking.person.badges"></span></div>
      </div>
    </div>
  </div>
</div>

<!-- contact person information -->
<div class="card" ng-if="userPerspective==='renter' && resource.contactPerson && (resource.contactPerson.id !== resource.owner.id)">
  <div class="card-heading">
    <h3 class="card-title">
      Gegevens van de beheerder
    </h3>
    <div class="media">
      <img class="media-object pull-left img-user-small" person-profile-image="{ person: resource.contactPerson, size: 'small' }" hide-xs />
      <div class="media-body">
        <ul class="list-unstyled list-block list-spaced">
          <li><md-icon>person_outline</md-icon>
            {{ resource.contactPerson | fullname }}
          </li>
          <li ng-if="resource.contactPerson.created"><md-icon>perm_contact_calendar</md-icon> 
            {{ resource.contactPerson.created | memberSince }}
          </li>
          <li ng-if="resource.contactPerson.streetName"><md-icon>place</md-icon>
            {{ resource.contactPerson.streetName }} {{ resource.contactPerson.streetNumber }}, {{ resource.contactPerson.city }}
          </li>
          <li ng-if="resource.contactPerson.phoneNumbers[0].number"><md-icon>phone</md-icon>
            {{ resource.contactPerson.phoneNumbers[0].number }}
            <small ng-if="resource.contactPerson.phoneNumbers[0].verified" class="text-success">(geverifieerd)</small>
          </li>
          <li><md-icon>comment</md-icon>
            <a ng-click="openChatWith(resource.contactPerson)">{{ 'SEND_MESSAGE' | translate }}</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- received invoices -->
<div class="card" ng-if="receivedInvoices.length > 0 && (sentInvoices.length === 0 || userPerspective === 'renter')">
  <div class="card-heading">
    <h3 class="card-title">
      {{ 'COSTS' | translate }}
    </h3>
  </div>
  <div uib-collapse="isInvoicesCollapsed">
    <div class="card-body">
      <table class="table">
        <tr>
          <th>Omschrijving</th>
          <th class="text-right xs-collapse">Aantal</th>
          <th class="text-right xs-collapse">Prijs</th>
          <th class="text-right">Totaal</th>
          <th class="text-right xs-collapse">Btw</th>
        </tr>
        <tr ng-repeat="invoiceline in invoiceLines">
          <td>{{ invoiceline.description }}</td>
          <td class="number xs-collapse">{{ invoiceline.quantity }}</td>
          <td class="number xs-collapse">{{ invoiceline.type == 'sent' ? -invoiceline.price : invoiceline.price | currency }}</td>
          <td class="number" ng-class="{'text-pos': invoiceline.total < 0}">{{ invoiceline.total | currency }}</td>
          <td class="number xs-collapse">{{ invoiceline.taxRate }}%</td>
        </tr>
        <tr>
          <td colspan="1"><b>Totaal te {{(receivedInvoicesTotalAmount > 0 ? 'betalen' : 'ontvangen')}}</b></td>
          <td colspan="2" class="xs-collapse"></td>
          <td class="text-right">
              <b>{{(receivedInvoicesTotalAmount < 0 ? -1 * receivedInvoicesTotalAmount : receivedInvoicesTotalAmount) | currency }}</b>
<!--             &nbsp;<button type="button" class="btn btn-primary pull-right" ng-click="payInvoices()">Betalen</button> -->
          </td>
          <td class="xs-collapse"></td>
        </tr>
      </table>
    </div>
  </div>
</div>

<!-- sent invoices -->
<div class="card" ng-if="sentInvoices.length > 0">
  <div class="card-heading">
    <h3 class="card-title">
      {{ 'BOOKING_SENT_INVOICES_TITLE' | translate }}
    </h3>
  </div>
  <div uib-collapse="isSentInvoicesCollapsed">
    <div class="card-body">
      <table class="table">
        <tr>
          <th>Omschrijving</th>
          <th class="text-right xs-collapse">Aantal</th>
          <th class="text-right xs-collapse">Prijs</th>
          <th class="text-right">Totaal</th>
          <th class="text-right xs-collapse">Btw</th>
        </tr>
        <tr ng-repeat="invoiceline in invoiceLines">
          <td>{{ invoiceline.description }}</td>
          <td class="number xs-collapse">{{ invoiceline.quantity }}</td>
          <td class="number xs-collapse">{{ invoiceline.type == 'sent' ? invoiceline.price : -invoiceline.price | currency }}</td>
          <td class="number" ng-if="invoiceline.type == 'sent'" ng-class="{'text-neg': invoiceline.total < 0}">{{ invoiceline.total | currency }}</td>
          <td class="number" ng-if="invoiceline.type == 'received'" ng-class="{'text-neg': invoiceline.total > 0}">{{ -invoiceline.total | currency }}</td>
          <td class="number xs-collapse">{{ invoiceline.taxRate }}%</td>
        </tr>
        <tr>
          <td colspan="1"><b>Totaal te {{(sentInvoicesTotalAmount - receivedInvoicesTotalAmount < 0 ? 'betalen' : 'ontvangen')}} </b></td>
          <td colspan="2" class="xs-collapse"></td>
          <td class="text-right">
            <b>{{ (sentInvoicesTotalAmount - receivedInvoicesTotalAmount < 0 ? -1* (sentInvoicesTotalAmount - receivedInvoicesTotalAmount) : sentInvoicesTotalAmount - receivedInvoicesTotalAmount) | currency }}</b>
          </td>
          <td class="xs-collapse"></td>
        </tr>
      </table>
    </div>
  </div>
</div>

<!-- declarations -->
<div class="card" ng-if="allowDeclarations">
  <div class="card-heading">
    <h3 class="card-title">
      {{ 'DECLARATION_TITLE' | translate }}
    </h3>
  </div>
  <div uib-collapse="isDeclarationsCollapsed ">
    <div class="card-body">
      <div class="row">
        <div class="col-sm-12" ng-repeat="declaration in booking.declarations">
          <div class="declarations__item">
            <div class="declarations__item__image" ng-style="{'background-image': 'url('+appConfig.serverUrl+'/declaration/' + declaration.image + ')'}" ng-click="openDialog($event, declaration)"></div>
            <div class="declarations__item__text">
              <p class="declarations__item__amount">&euro;{{::declaration.amount|number:2}}</p>
              <p><small>{{ 'DECL_LABEL_DATE' | translate }}</small><br>{{::declaration.created}}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="row" ng-if="!booking.declarations || booking.declarations.length == 0">
        <div class="col-sm-12">{{ 'DECL_NO_DEC_SHOW' | translate }}</div>
      </div>
      <div class="row" style="margin-top: 2em;" ng-if="allowDeclarationsAdd">
        <div class="col-sm-12"><a class="btn btn-default" ui-sref="^.administer">{{ 'DECL_ADD' | translate }}</a></div>
      </div>
    </div>
  </div>
</div>

<!-- map -->
<div class="card" ng-if="resource.location || resource.city">
  <div class="card-heading">
    <h3 class="card-title">{{ resource.location }} {{ resource.streetNumber }} <small>{{ resource.city }}</small></h3>
  </div>
  <ui-gmap-google-map
       center="map.center"
       zoom="map.zoom"
       draggable="false"
       dragging="map.dragging"
       bounds="map.bounds"
       events="map.events"
       options="map.options">
       <ui-gmap-marker ng-repeat="m in map.markers" idKey="m.idKey" coords="m" icon="m.icon"></ui-gmap-marker>
  </ui-gmap-google-map>
</div>